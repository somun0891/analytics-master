version: 2

models:
  - name: mart_arr
    description: '{{ doc("mart_arr") }}'
    columns:
      - name: arr
        description: "Calculated as 12 * MRR value"
      - name: primary_key
        data_tests:
          - not_null
          - unique
      - name: is_reseller
        description: Identify whether a crm_account is a reseller.
      - name: subscription_sales_type
        description: Identifies whether a subscription is Sales-Assisted or Self-Service / Web Direct.
      - name: billing_account_number
        data_tests:
          - not_null
      - name: subscription_name_slugify
        data_tests:
          - not_null
      - name: subscription_name
        data_tests:
          - not_null
      - name: oldest_subscription_in_cohort
      - name: subscription_lineage
      - name: arr_month
        data_tests:
          - not_null
      - name: subscription_cohort_month
      - name: subscription_cohort_quarter
      - name: mrr
        data_tests:
          - not_null
      - name: months_since_subscription_cohort_start
      - name: quarters_since_subscription_cohort_start
      - name: dim_billing_account_id
        data_tests:
          - not_null
      - name: billing_account_name
        data_tests:
          - not_null
      - name: product_tier_name
        data_tests:
          - not_null
      - name: unit_of_measure
      - name: quantity
      - name: dim_crm_account_id
      - name: crm_account_name
      - name: ultimate_parent_account_id
      - name: ultimate_parent_account_name
      - name: billing_account_cohort_month
      - name: billing_account_cohort_quarter
      - name: crm_account_cohort_month
      - name: crm_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_month") }}'
      - name: parent_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_quarter") }}'
      - name: months_since_billing_account_cohort_start
      - name: quarters_since_billing_account_cohort_start
      - name: months_since_crm_account_cohort_start
      - name: quarters_since_crm_account_cohort_start
      - name: months_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_months_since_parent_cohort_start") }}'
      - name: quarters_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_quarters_since_parent_cohort_start") }}'
      - name: dim_subscription_id
      - name: dim_subscription_id_original
      - name: was_purchased_through_reseller
        description: Boolean field that indicates whether the subscription was purchased through a reseller. If TRUE, the `invoice_owner_account` will contain the name of the reseller.
      - name: is_licensed_user
        description: Flag to identify licensed users. It works by excluding `Storage` product_tier
      - name: is_arpu
        description: Flag to identify what counts towards Annual Revenue Per User (ARPU). It works by excluding `Storage` product_tier and `EDU` product_rate_plan.
      - name: product_deployment_type
        description: How a product is deployed to the customer; Self-Managed, GitLab.com or Dedicated (or Other).
      - name: product_category
        description: Categorizes Zuora products as either Add On Services or Base Products
      - name: product_rate_plan_category
        description: On created opportunities (Web store/Sales assisted), the Product category field is be populated at the Rate plan level in Salesforce. Aides identification of Agile Planning and Duo Pro SKUs, flowing from salesforce.

  - name: mart_arr_jihu
    description: '{{ doc("mart_arr_jihu") }}'
    columns:
      - name: arr
        description: "Calculated as 12 * MRR value"
      - name: primary_key
        data_tests:
          - not_null
          - unique
      - name: is_reseller
        description: Identify whether a crm_account is a reseller.
      - name: subscription_sales_type
        description: Identifies whether a subscription is Sales-Assisted or Self-Service / Web Direct.
      - name: billing_account_number
        data_tests:
          - not_null
      - name: subscription_name_slugify
        data_tests:
          - not_null
      - name: subscription_name
        data_tests:
          - not_null
      - name: oldest_subscription_in_cohort
      - name: subscription_lineage
      - name: arr_month
        data_tests:
          - not_null
      - name: subscription_cohort_month
      - name: subscription_cohort_quarter
      - name: mrr
        data_tests:
          - not_null
      - name: months_since_subscription_cohort_start
      - name: quarters_since_subscription_cohort_start
      - name: dim_billing_account_id
        data_tests:
          - not_null
      - name: billing_account_name
        data_tests:
          - not_null
      - name: product_tier_name
        data_tests:
          - not_null
      - name: unit_of_measure
      - name: quantity
      - name: dim_crm_account_id
      - name: crm_account_name
      - name: ultimate_parent_account_id
      - name: ultimate_parent_account_name
      - name: billing_account_cohort_month
      - name: billing_account_cohort_quarter
      - name: crm_account_cohort_month
      - name: crm_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_month") }}'
      - name: parent_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_quarter") }}'
      - name: months_since_billing_account_cohort_start
      - name: quarters_since_billing_account_cohort_start
      - name: months_since_crm_account_cohort_start
      - name: quarters_since_crm_account_cohort_start
      - name: months_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_months_since_parent_cohort_start") }}'
      - name: quarters_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_quarters_since_parent_cohort_start") }}'
      - name: dim_subscription_id
      - name: dim_subscription_id_original

  - name: mart_arr_snapshot_bottom_up
    description: Daily snapshots of MRR/ARR by month values per customer, subscription and product. Built using the snapshotted source tables.
    columns:
      - name: primary_key
        data_tests:
          - unique:
              config:
                where: "arr_month >= DATEADD('month',-3,CURRENT_DATE())"
          - not_null
        tags: ["tdf", "mart", "arr"]
      - name: was_purchased_through_reseller
        description: Boolean field that indicates whether the subscription was purchased through a reseller. If TRUE, the `invoice_owner_account` will contain the name of the reseller.
      - name: dim_charge_id
        description: Unique identifier for a rate plan charge in Zuora. These are transactions in Zuora Billing.

  - name: mart_arr_snapshot_model
    description: Simpler incremental version of the mart_arr snapshot model
    columns:
        - name: primary_key
          data_tests:
            - not_null
          tags: [ "tdf", "mart", "arr" ]

  - name: mart_arr_weekly_with_zero_dollar_charges
    description: A version of mart_arr aggregated by arr_week. This allows more frequent updates to the arr and quantity fields for faster analysis.
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique

  - name: mart_charge
    description: Model combining Subscription related objects such as product details and rate plan charge details into a mart.
    columns:
      - name: dim_charge_id
        description: The unique identifier of a rate plan charge
        data_tests:
          - not_null
          - unique
      - name: was_purchased_through_reseller
        description: Boolean field that indicates whether the subscription was purchased through a reseller. If TRUE, the `invoice_owner_account` will contain the name of the reseller.
      - name: subscription_renewal_type
        description: Calculated field that indicates how a subscription renewal was made. Can be one of 'Auto-Renewal', 'Customer Portal', 'Sales-Assisted' or null when the charge is not related to a subscription renewal.
      - name: dim_order_id
        description: Unique identifier for an order. Can be used to join to dim_order.
      - name: unit_of_measure
      - name: charge_term
      - name: dim_subscription_id_original
      - name: dim_subscription_id_previous
      - name: renewal_term
      - name: renewal_term_period_type
      - name: ultimate_parent_namespace_id
      - name: dim_namespace_id
      - name: internal_customer_id
        description: Unique identifier of a customer taken from the Customers DB.
      - name: is_trial_converted
        description: '{{ doc("is_trial_converted") }}'
      - name: latest_trial_start_date
      - name: is_first_paid_order
        description: Boolean field indicating whether the charge relates to the first order made by that ultimate_parent_namespace_id. If two charges are processed on the same date, both will be true.
      - name: is_oss_or_edu_rate_plan
      - name: days_since_trial_start_at_first_paid_subscription_start
        description: The number of days between the start date of the latest trial and first paid subscription.
      - name: days_since_namespace_creation_at_trial_start
        description: The number of days between the start date of the latest trial and namespace creation.
      - name: is_trial_started_on_namespace_creation_date
        description: Boolean field indicating whether the namespace was created on the same date as the latest trial started.
      - name: days_between_first_trial_and_subscription_start
        description: Calculated field showing the number of days between the start of the first trial and the start of the first subscription.
      - name: days_between_latest_trial_and_subscription_start
        description: Calculated field showing the number of days between the start of the latest trial and the start of the first subscription.
      - name: subscription_name
      - name: subscription_version
      - name: rate_plan_charge_number
      - name: rate_plan_charge_version
      - name: rate_plan_charge_segment
      - name: rate_plan_name
      - name: rate_plan_charge_name
      - name: rate_plan_charge_description
      - name: charge_type
      - name: is_paid_in_full
      - name: is_last_segment
      - name: is_included_in_arr_calc
      - name: effective_start_date
      - name: effective_end_date
      - name: effective_start_month
      - name: effective_end_month
      - name: charge_created_date
      - name: charge_updated_date
      - name: dim_subscription_id
      - name: subscription_created_by_id
      - name: subscription_updated_by_id
      - name: subscription_start_date
      - name: subscription_end_date
      - name: subscription_start_month
      - name: subscription_end_month
      - name: subscription_end_fiscal_year
      - name: subscription_created_date
      - name: subscription_updated_date
      - name: second_active_renewal_month
      - name: term_start_date
      - name: term_end_date
      - name: term_start_month
      - name: term_end_month
      - name: subscription_status
      - name: subscription_sales_type
      - name: subscription_name_slugify
      - name: oldest_subscription_in_cohort
      - name: subscription_lineage
      - name: auto_renew_native_hist
      - name: auto_renew_customerdot_hist
      - name: turn_on_cloud_licensing
      - name: turn_on_operational_metrics
      - name: contract_operational_metrics
      - name: contract_auto_renewal
      - name: turn_on_auto_renewal
      - name: contract_seat_reconciliation
      - name: turn_on_seat_reconciliation
      - name: invoice_owner_account
      - name: creator_account
      - name: dim_billing_account_id
      - name: sold_to_country
      - name: billing_account_name
      - name: billing_account_number
      - name: ssp_channel
      - name: po_required
      - name: auto_pay
      - name: default_payment_method_type
      - name: dim_crm_user_id
      - name: crm_user_sales_segment
      - name: dim_crm_account_id
        description: '{{ doc("dim_crm_account_id") }}'
      - name: crm_account_name
        description: '{{ doc("crm_account_name") }}'
      - name: dim_parent_crm_account_id
        description: '{{ doc("dim_parent_crm_account_id") }}'
      - name: parent_crm_account_name
        description: '{{ doc("parent_crm_account_name") }}'
      - name: parent_crm_account_upa_country
      - name: parent_crm_account_sales_segment
      - name: parent_crm_account_industry
      - name: parent_crm_account_territory
      - name: parent_crm_account_region
      - name: parent_crm_account_area
      - name: health_score_color
      - name: health_number
      - name: is_jihu_account
      - name: subscription_cohort_month
      - name: subscription_cohort_quarter
      - name: billing_account_cohort_month
      - name: billing_account_cohort_quarter
      - name: crm_account_cohort_month
      - name: crm_account_cohort_quarter
      - name: parent_account_cohort_month
      - name: parent_account_cohort_quarter
      - name: dim_product_detail_id
      - name: product_tier_name
        description: '{{ doc("product_tier_name") }}'
      - name: product_delivery_type
        description: '{{ doc("product_delivery_type") }}'
      - name: product_ranking
        description: '{{ doc("product_ranking") }}'
      - name: service_type
      - name: product_rate_plan_name
      - name: is_licensed_user
      - name: is_arpu
      - name: dim_amendment_id_subscription
      - name: dim_amendment_id_charge
      - name: subscription_amendment_effective_date
      - name: subscription_amendment_type
      - name: subscription_amendment_name
      - name: charge_amendment_type
      - name: type_of_arr_change
        description: '{{ doc("type_of_arr_change") }}'
      - name: mrr
      - name: previous_mrr
      - name: delta_mrr
      - name: arr
      - name: previous_arr
      - name: delta_arr
      - name: quantity
      - name: previous_quantity
      - name: delta_quantity
      - name: delta_tcv
      - name: estimated_total_future_billings
      - name: product_deployment_type
        description: How a product is deployed to the customer; Self-Managed, GitLab.com or Dedicated (or Other)
      - name: product_category
        description: Categorizes Zuora products as either Add On Services or Base Products
      - name: product_rate_plan_category
        description: On created opportunities (Web store/Sales assisted), the Product category field is be populated at the Rate plan level in Salesforce. Aides identification of Agile Planning and Duo Pro SKUs, flowing from salesforce.


  - name: mart_crm_account
    description: Model containing Salesforce crm accounts details for existing and historical customers.
    columns:
      - name: dim_crm_account_id
        data_tests:
            - not_null
            - unique
      - name: gs_health_user_engagement
        description: ' {{ doc("gs_health_user_engagement") }} '
      - name: gs_health_cd
        description: ' {{ doc("gs_health_cd") }} '
      - name: gs_health_devsecops
        description: ' {{ doc("gs_health_devsecops") }} '
      - name: gs_health_ci
        description: ' {{ doc("gs_health_ci") }} '
      - name: gs_health_scm
        description: ' {{ doc("gs_health_scm") }} '
      - name: eoa_sentiment
        description: ' {{ doc("eoa_sentiment") }} '
      - name: gs_first_value_date
        description: ' {{ doc("gs_first_value_date") }} '
      - name: gs_last_csm_activity_date
        description: ' {{ doc("gs_last_csm_activity_date") }} '
      - name: last_at_risk_update_comments
        description: ' {{ doc("last_at_risk_update_comments") }} '
      - name: bdr_prospecting_status
        description: Indicates whether the account is actively being prospected by a BDR.
      - name: six_sense_6_qa
        description: The 6QA status of the account for the product.
      - name: risk_rate_guid
        description: The globally unique ID (GUID) for the third party record in NavEx RiskRate.
      - name: six_sense_account_profile_fit
        description: A measure of how similar a company is to the ideal customer profile.
      - name: six_sense_account_reach_score
        description: A measure of current outreach activities against optimal quality.
      - name: six_sense_account_profile_score
        description: A measure of how similar a company is to the ideal customer profile.
      - name: six_sense_account_buying_stage
        description: The 6QA buting stage of the account
      - name: six_sense_account_numerical_reach_score
        description:  measure of current outreach activities against optimal quality.
      - name: six_sense_account_update_date
        description: The latest update date and time when 6sense Scores were updated.
      - name: six_sense_account_6_qa_end_date
        description: The date the account was disqualified from 6QA status 
      - name: six_sense_account_6_qa_age_days
        description: The age of the Account's 6QA data, in days. 
      - name: six_sense_account_6_qa_start_date
        description: The date the account qualified for 6QA status 
      - name: six_sense_account_intent_score
        description: A measure, between 0 and 100, of how much an account is behaving like accounts with which there is a history of previously opened opportunities.
      - name: six_sense_segments
        description: The Account's 6QA segment. 
      - name: pte_score
        description: Propensity to expand scores from pte_scores_source
      - name: pte_decile
      - name: pte_score_group
      - name: ptc_score
        description: Propensity to contract and churn scores from ptc_scores_source
      - name: ptc_decile
      - name: ptc_score_group
      - name: tam_manager
        description: The name of the manager for technical account manager who manages the account
      - name: gs_health_csm_sentiment
        description: This is what the TAM thinks the health of this account should be - Formerly was just Health Score - Gainsight is the SSOT for this field and its value can only be updated in Gainsight.
      - name: crm_account_owner_manager
        description: The name of the manager of the crm account owner
      - name: executive_sponsor
        description: executive sponsor of this account
      - name: bdr_next_steps
        description: Outlines the next steps that connect to the prospecting strategy for this account.
      - name: bdr_account_research
        description: Displays the research that was made on account to justify the account's addition to a prospecting list.
      - name: bdr_account_strategy
        description: Aggregates the path for approaching the account into some more general buckets
      - name: account_bdr_assigned_user_role
        description: The region and segment specific role of the BDR assigned to an account.
      - name: bdr_recycle_date
        description: Automatically populates two months out from the actively working start date to indicate when an outbound account should be considered for removal from the outbound pipeline.
      - name: actively_working_start_date
        description: Automatically datestamps the date and time that an account was moved to a BDRs outbound prospecting list.
      - name: qualified_days_since_last_activity
        description: Qualified's calculation, in days, of time elapsed since last activity on the account. 
      - name: qualified_signals_active_session_time
        description: Qualified's calculation of active session time. 
      - name: qualified_signals_bot_conversation_count
        description: Qualified's count of bot conversations. 
      - name: qualified_condition
        description: Qualified's Account condition
      - name: qualified_score
        description: Qualified's Account score
      - name: qualified_trend
        description: Qualified's Account trend
      - name: qualified_meetings_booked
        description: Qualified's count of booked meetings on the account
      - name: qualified_signals_rep_conversation_count
        description: Qualified's count of rep conversations
      - name: qualified_signals_research_state
        description: Qualified's Account research state.
      - name: qualified_signals_research_score
        description: Qualified's Account research score
      - name: qualified_signals_session_count
        description: Qualified's count of sessions on the account
      - name: qualified_visitors_count
        description: Qualified's count of visitors on the account
      - name: account_domains
        description: All domain names associated with this account, separated by a comma.
      - name: dnb_match_confidence_score
        description: This is a 1-10 number that describes the level of confidence in match quality between our Salesforce record and D&B's Company record. 10 means D&B is confident that this is a high quality match.
      - name: dnb_match_grade
        description: This is a series of letters (A, B, F, Z) that describe the match grade between our Salesforce record and D&B's Company record within particular fields. A means values match exactly, B means values are similar, F means values are different, and Z means values are missing. Fields are graded in this order - Account Name, Street number, Street Name, City, State/Region, Mailing Address, Telephone, Postal Code, Density, Uniqueness, Industry.
      - name: dnb_connect_company_profile_id
        description: This is the id of the D&B Connect Company Profile record that has been matched to this Salesforce Account record.
      - name: dnb_duns
        description: The Data Universal Numbering System (DUNS) is a 9-digit id number created by D&B to identify a business entity at a particular location.
      - name: dnb_global_ultimate_duns
        description: This is the DUNS of the highest global corporate linkage in this company hierarchy.
      - name: dnb_domestic_ultimate_duns
        description: This is the DUNS of the highest domestic corporate linkage (within each country) in this company hierarchy.
      - name: dnb_exclude_company
        description: This checkbox indicates that this Account record has been excluded from D&B enrichment.

  - name: mart_crm_opportunity
    description:  >-
      Model with single pane of glass over the sales and marketing metrics. Depending on your use case, you might use  `mart_crm_opportunity_stamped_hierarchy_hist` or `mart_crm_opportunity.`
      `mart_crm_opportunity_stamped_hierarchy_hist` should be used for year-over-year comparisons as it accounts for yearly changes in the sales hierarchy, views all account hierarchies through the lens of the current year hierarchy, and it reflects how the sales hierarchy is applied in practice (ie. Hybrid users are assigned to the account's hierarchy)
    columns:
      - name: dim_crm_opportunity_id
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]
      - name: order_type
        description: '{{ doc("order_type") }}'
      - name: order_type_current
        description: '{{ doc("order_type_current") }}'
      - name: vsa_readout
        description: '{{ doc("vsa_readout") }}'
      - name: vsa_start_date_net_arr
        description: '{{ doc("vsa_start_date_net_arr") }}'
      - name: vsa_start_date
        description: '{{ doc("vsa_start_date") }}'
      - name: vsa_url
        description: '{{ doc("vsa_url") }}'
      - name: vsa_status
        description: '{{ doc("vsa_status") }}'
      - name: vsa_end_date
        description: '{{ doc("vsa_end_date") }}'
      - name: won_arr_basis_for_clari
        description: '{{ doc("won_arr_basis_for_clari") }}'
      - name: arr_basis_for_clari
        description: '{{ doc("arr_basis_for_clari") }}'
      - name: forecasted_churn_for_clari
        description: '{{ doc("forecasted_churn_for_clari") }}'
      - name: override_arr_basis_clari
        description: '{{ doc("override_arr_basis_clari") }}'
      - name: downgrade_details
        description: '{{ doc("downgrade_details") }}'
      - name: intended_product_tier
        description: '{{ doc("intended_product_tier") }}'
      - name: dim_parent_crm_opportunity_id
        description: '{{ doc("dim_parent_crm_opportunity_id") }}'
      - name: next_steps
        description: Free text field that provides insight into the next step to continue progressing the Opportunity through the Sales Pipeline.
      - name: auto_renewal_status
        descripton: Flag with on/off. Indicates whether a current subscription will automatically renew for the same term as their current subscription after the expiration of the current term
      - name: qsr_notes
        description: '{{ doc("qsr_notes") }}'
      - name: qsr_status  
        description: Quarterly Subscription Reconciliation status (Pending, failed, processed)
      - name: manager_confidence
      - name: renewal_risk_category
        description: Renewal forecasting field indicating whether the customer will renew, churn or contract (actionable or not)
      - name: renewal_swing_arr
        description: The revenue the Account team believes can be saved on an at-risk Renewal if action is taken
      - name: renewal_manager
        description:  Renewals Manager supporting this Opportunity
      - name: renewal_forecast_health
        description: Red, Yellow, Green health rating based on the Net ARR field
      - name: is_abm_tier_sao
        description: A flag that indicates whether or not the opportunity's account was in an ABM Tier at the time of SAO
      - name: is_abm_tier_closed_won
        description: A flag that indicates whether or not the opportunity's account was in an ABM Tier at the time of Closed Won
      - name: ptc_predicted_arr
        description: This field contains the predicted amount of ARR after renewal, generated by a machine learning model when the subscription is within 6 months of renewal date.
      - name: ptc_predicted_renewal_risk_category
        description: This field contains the predicted renewal risk category, generated by a machine learning model when the subscription is within 6 months of renewal date.
      - name: xdr_net_arr_stage_1
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 1 in SFDC.
      - name: xdr_net_arr_stage_3
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 3 in SFDC.
      - name: enterprise_agile_planning_net_arr
        description: The net arr related to the Enterprise Agile Planning element of the opportunity.
      - name: duo_net_arr
        description: The net arr related to the GitLab Duo element of the opportunity.
      - name: partner_margin_percentage
        description: The percentage of the opportunity net arr to which the partner is entitled.
      - name: net_arr_stage_1
        description: The total Net Arr of the SFDC opportunity, as they move to/past Stage 1.
      - name: valid_deal_count
        description: A Salesforce Opportunity field that gives a -1, 0, or 1 value based on whether or not it should be counted as a true closed won for accounting/reporting purposes
      - name: professional_services_value
        description: Amount on an opportunity that is from Professional Services only
      - name: edu_services_value
        description: Amount on an opportunity that is from Educational Services only
      - name: investment_services_value
        description: Amount on an opportunity that is from Investment Services only
      - name: sales_dev_rep_user_role_level_1
        description: The Sales Dev Rep's role hierarchy level 1
      - name: sales_dev_rep_user_role_level_2
        description: The Sales Dev Rep's role hierarchy level 2
      - name: sales_dev_rep_user_role_level_3
        description: The Sales Dev Rep's role hierarchy level 3
      - name: sales_dev_rep_leader_full_name
        description: The Sales Dev Rep's Leader's full name. 
      - name: sales_dev_manager_full_name
        description: The Sales Dev Rep's Manager's full name. 
      - name: sales_dev_rep_user_full_name
        description: The Sales Dev Rep's Full Name
      - name: aggregate_partner
        description: The Aggregate Partner field shows the primary partner, using the Resale Partner first, or the Deal Registration partner if the Resale Partner isn't available.
      - name: startup_type
        description: Indicates what type of startup opportunity (Seed vs. Early Stage)

  - name: mart_crm_opportunity_daily_snapshot
    description: Model with single pane of glass sales and marketing metrics, snapshotted daily.
    columns:
      - name: crm_opportunity_snapshot_id
        data_tests:
            - not_null
            - unique
            - relationships:
                to: ref('fct_crm_opportunity_daily_snapshot')
                field: crm_opportunity_snapshot_id
        tags: ["tdf", "mart", "sales_funnel"]
      - name: dim_crm_opportunity_id
        data_tests:
            - not_null
      - name: snapshot_date
        data_tests:
          - not_null
      - name: order_type
        description: '{{ doc("order_type") }}'
      - name: order_type_current
        description: '{{ doc("order_type_current") }}'
      - name: vsa_readout
        description: '{{ doc("vsa_readout") }}'
      - name: vsa_start_date_net_arr
        description: '{{ doc("vsa_start_date_net_arr") }}'
      - name: vsa_start_date
        description: '{{ doc("vsa_start_date") }}'
      - name: vsa_url
        description: '{{ doc("vsa_url") }}'
      - name: vsa_status
        description: '{{ doc("vsa_status") }}'
      - name: vsa_end_date
        description: '{{ doc("vsa_end_date") }}'
      - name: won_arr_basis_for_clari
        description: '{{ doc("won_arr_basis_for_clari") }}'
      - name: arr_basis_for_clari
        description: '{{ doc("arr_basis_for_clari") }}'
      - name: forecasted_churn_for_clari
        description: '{{ doc("forecasted_churn_for_clari") }}'
      - name: override_arr_basis_clari
        description: '{{ doc("override_arr_basis_clari") }}'
      - name: downgrade_details
        description: '{{ doc("downgrade_details") }}'
      - name: cycle_time_in_days
        description: '{{ doc("cycle_time_in_days") }}'
      - name: cycle_time_in_days
        description: '{{ doc("cycle_time_in_days") }}'  
      - name: ptc_predicted_arr
        descripion: This field contains the predicted amount of ARR after renewal, generated by a machine learning model when the subscription is within 6 months of renewal date.
      - name: ptc_predicted_renewal_risk_category
        description: This field contains the predicted renewal risk category, generated by a machine learning model when the subscription is within 6 months of renewal date.
      - name: xdr_net_arr_stage_1
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 1 in SFDC.
      - name: xdr_net_arr_stage_3
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 3 in SFDC.
      - name: net_arr_stage_1
        description: The total Net Arr of the SFDC opportunity, as they move to/past Stage 1.
      - name: professional_services_value
        description: Amount on an opportunity that is from Professional Services only
      - name: edu_services_value
        description: Amount on an opportunity that is from Educational Services only
      - name: investment_services_value
        description: Amount on an opportunity that is from Investment Services only
      - name: aggregate_partner
        description: The Aggregate Partner field shows the primary partner, using the Resale Partner first, or the Deal Registration partner if the Resale Partner isn't available.

  - name: mart_crm_opportunity_stamped_hierarchy_hist
    description: >-
      Model with single pane of glass over the sales and marketing metrics.
      `mart_crm_opportunity_stamped_hierarchy_hist` accounts for yearly changes in the sales hierarchy, views all account hierarchies through the lens of the current year hierarchy, and it reflects how the sales hierarchy is applied in practice (ie. Hybrid users are assigned to the account's hierarchy).
      Also, for the `alliance_type` field it has the current state of the field instead of the historical version of it. For example,
      instead of showing the value Non-Alliance it shows Channel Partners.
    columns:
      - name: dim_crm_opportunity_id
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]
      - name: order_type
        description: '{{ doc("order_type") }}'
      - name: order_type_current
        description: '{{ doc("order_type_current") }}'
      - name: vsa_readout
        description: '{{ doc("vsa_readout") }}'
      - name: vsa_start_date_net_arr
        description: '{{ doc("vsa_start_date_net_arr") }}'
      - name: vsa_start_date
        description: '{{ doc("vsa_start_date") }}'
      - name: vsa_url
        description: '{{ doc("vsa_url") }}'
      - name: vsa_status
        description: '{{ doc("vsa_status") }}'
      - name: vsa_end_date
        description: '{{ doc("vsa_end_date") }}'
      - name: won_arr_basis_for_clari
        description: '{{ doc("won_arr_basis_for_clari") }}'
      - name: arr_basis_for_clari
        description: '{{ doc("arr_basis_for_clari") }}'
      - name: forecasted_churn_for_clari
        description: '{{ doc("forecasted_churn_for_clari") }}'
      - name: override_arr_basis_clari
        description: '{{ doc("override_arr_basis_clari") }}'
      - name: downgrade_details
        description: '{{ doc("downgrade_details") }}' 
      - name: next_steps
        description: Free text field that provides insight into the next step to continue progressing the Opportunity through the Sales Pipeline.
      - name: auto_renewal_status
        descripton: Flag with on/off. Indicates whether a current subscription will automatically renew for the same term as their current subscription after the expiration of the current term
      - name: qsr_notes
        description: '{{ doc("qsr_notes") }}'
      - name: qsr_status  
        description: Quarterly Subscription Reconciliation status (Pending, failed, processed)
      - name: manager_confidence
      - name: renewal_risk_category
        description: Renewal forecasting field indicating whether the customer will renew, churn or contract (actionable or not)
      - name: renewal_swing_arr
        description: The revenue the Account team believes can be saved on an at-risk Renewal if action is taken
      - name: renewal_manager
        description:  Renewals Manager supporting this Opportunity
      - name: renewal_forecast_health
        description: Red, Yellow, Green health rating based on the Net ARR field
      - name: xdr_net_arr_stage_1
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 1 in SFDC.
      - name: xdr_net_arr_stage_3
        description: The XDR influenced value of an Opportunity's Net ARR as of Stage 3 in SFDC.
      - name: net_arr_stage_1
        description: The total Net Arr of the SFDC opportunity, as they move to/past Stage 1.
      - name: valid_deal_count
        description: A Salesforce Opportunity field that gives a -1, 0, or 1 value based on whether or not it should be counted as a true closed won for accounting/reporting purposes

  - name: mart_sales_funnel_target
    description: Model with Sales targets used for planning the go to market Sales and Marketing motion.
    columns:
      - name: sales_funnel_target_id
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]

  - name: mart_sales_funnel_target_daily
    description: Model with Sales targets at a daily level and with QTD (Quater To Date), MTD (Month To Date) and YTD (Year To Date) target calculations.
    columns:
      - name: primary_key
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]
      - name: report_target_date
        description: '{{ doc("report_target_date") }}'
      - name: wtd_allocated_target
        description: '{{ doc("wtd_allocated_target") }}'
      - name: mtd_allocated_target
        description: '{{ doc("mtd_allocated_target") }}'
      - name: qtd_allocated_target
        description: '{{ doc("qtd_allocated_target") }}'
      - name: ytd_allocated_target
        description: '{{ doc("ytd_allocated_target") }}'

  - name: mart_sales_funnel_partner_alliance_target
    description: Model with Sales targets for partner and alliances used for planning the go to market Sales and Marketing motion.
    columns:
      - name: sales_funnel_partner_alliance_target_id
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]

  - name: mart_sales_funnel_partner_alliance_target_daily
    description: Model with Sales targets for partner and alliances at a daily level and with QTD (Quater To Date), MTD (Month To Date) and YTD (Year To Date) target calculations.
    columns:
      - name: primary_key
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "sales_funnel"]
      - name: report_target_date
        description: '{{ doc("report_target_date") }}'
      - name: wtd_allocated_target
        description: '{{ doc("wtd_allocated_target") }}'
      - name: mtd_allocated_target
        description: '{{ doc("mtd_allocated_target") }}'
      - name: qtd_allocated_target
        description: '{{ doc("qtd_allocated_target") }}'
      - name: ytd_allocated_target
        description: '{{ doc("ytd_allocated_target") }}'

  - name: mart_discount_arr
    description: Model with Invoiced ARR used to calculate discounts across various dimensions.
    columns:
      - name: primary_key
        description: Unique identifier of a product charge on the invoice amortized by month.
        data_tests:
            - not_null
            - unique
        tags: ["tdf", "mart", "arr"]
      - name: is_myb
        description: Identifies if a subscription charge is for a multiple year term.
      - name: current_term_months
        description: Term of the subscription in months.
      - name: current_term_years
        description: Term of the subscription in years. Rounds to the one decimal point. For examples, an 18 month term subscription will be a 1.5 year term.

  - name: mart_delta_arr_parent_month
    description: "Mart table by month pursuant to the ARR Analysis Framework at the parent customer level"
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
        tags: ["tdf", "mart", "arr"]

  - name: mart_delta_arr_parent_product_month
    description: "Mart table by month pursuant to the ARR Analysis Framework at the parent customer || product category level"
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
        tags: ["tdf", "mart", "arr"]
      - name: product_tier_name
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]
      - name: product_delivery_type
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]
      - name: product_ranking
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]

  - name: mart_delta_arr_subscription_product_month
    description: "Mart table by month purusant to the ARR Analysis Framework at the subscription || product_category level"
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
        tags: ["tdf", "mart", "arr"]
      - name: product_category
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]
      - name: delivery
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]
      - name: product_ranking
        data_tests:
          - not_null
        tags: ["tdf", "mart", "arr"]

  - name: mart_delta_arr_subscription_month
    description: "Mart table by month purusant to the ARR Analysis Framework at the subscription level"
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
        tags: ["tdf", "mart", "arr"]

  - name: mart_retention_parent_account_product
    description: "Mart table to support retention analysis at the ultimate_parent_account || product level."
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
        tags: ["tdf", "mart", "arr"]

  - name: mart_retention_crm_account
    description: "Mart table to support drillable retention analysis by the CRM account grain."
    columns:
    - name: fct_retention_id
      description: A unique identifier of the retention record.
      data_tests:
        - not_null
        - unique
      tags: ["tdf", "mart", "arr", "retention"]

  - name: mart_retention_parent_account
    description: "Mart table to support drillable retention analysis by the Parent CRM account grain"
    columns:
    - name: fct_retention_id
      description: A unique identifier of the retention record.
      data_tests:
        - not_null
        - unique
      tags: ["tdf", "mart", "arr", "retention"]


  - name: mart_arr_with_zero_dollar_charges
    description: '{{ doc("mart_arr_with_zero_dollar_charges") }}'
    columns:
      - name: primary_key
        data_tests:
          - not_null
          - unique
      - name: arr_month
        data_tests:
          - not_null
      - name: fiscal_quarter_name_fy
      - name: fiscal_year
      - name: subscription_start_month
      - name: subscription_end_month
      - name: sold_to_country
      - name: billing_account_number
      - name: ssp_channel
      - name: po_required
      - name: auto_pay
      - name: default_payment_method_type
      - name: dim_parent_crm_account_id
      - name: parent_crm_account_name
      - name: parent_crm_account_sales_segment
      - name: arr
        description: "Calculated as 12 * MRR value"
      - name: is_reseller
        description: Identify whether a crm_account is a reseller.
      - name: subscription_sales_type
        description: Identifies whether a subscription is Sales-Assisted or Self-Service / Web Direct.
      - name: billing_account_number
        data_tests:
          - not_null
      - name: subscription_name_slugify
        data_tests:
          - not_null
      - name: subscription_name
        data_tests:
          - not_null
      - name: oldest_subscription_in_cohort
      - name: subscription_lineage
      - name: subscription_cohort_month
      - name: subscription_cohort_quarter
      - name: mrr
        data_tests:
          - not_null
      - name: months_since_subscription_cohort_start
      - name: quarters_since_subscription_cohort_start
      - name: dim_billing_account_id
        data_tests:
          - not_null
      - name: billing_account_name
        data_tests:
          - not_null
      - name: product_tier_name
        data_tests:
          - not_null
      - name: unit_of_measure
      - name: quantity
      - name: dim_crm_account_id
      - name: crm_account_name
      - name: ultimate_parent_account_id
      - name: ultimate_parent_account_name
      - name: billing_account_cohort_month
      - name: billing_account_cohort_quarter
      - name: crm_account_cohort_month
      - name: crm_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_month") }}'
      - name: parent_account_cohort_quarter
        description: '{{ doc("mart_arr_col_parent_account_cohort_quarter") }}'
      - name: months_since_billing_account_cohort_start
      - name: quarters_since_billing_account_cohort_start
      - name: months_since_crm_account_cohort_start
      - name: quarters_since_crm_account_cohort_start
      - name: months_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_months_since_parent_cohort_start") }}'
      - name: quarters_since_parent_account_cohort_start
        description: '{{ doc("mart_arr_col_quarters_since_parent_cohort_start") }}'
      - name: dim_subscription_id
      - name: dim_subscription_id_original
      - name: was_purchased_through_reseller
        description: Boolean field that indicates whether the subscription was purchased through a reseller. If TRUE, the `invoice_owner_account` will contain the name of the reseller.
      - name: is_licensed_user
        description: Flag to identify licensed users. It works by excluding `Storage` product_tier
      - name: is_arpu
        description: Flag to identify what counts towards Annual Revenue Per User (ARPU). It works by excluding `Storage` product_tier and `EDU` product_rate_plan.
      - name: product_deployment_type
        description: How a product is deployed to the customer; Self-Managed, GitLab.com or Dedicated (or Other).
      - name: product_category
        description: Categorizes Zuora products as either Add On Services or Base Products
      - name: product_rate_plan_category
        description: On created opportunities (Web store/Sales assisted), the Product category field is be populated at the Rate plan level in Salesforce. Aides identification of Agile Planning and Duo Pro SKUs, flowing from salesforce.

  
  - name: mart_targets_actuals_7th_day_weekly_snapshot
    columns: 
      - name: targets_actuals_weekly_snapshot_pk
        data_tests:
          - not_null
          - unique
          - relationships:
              to: ref('fct_targets_actuals_7th_day_weekly_snapshot')
              field: targets_actuals_weekly_snapshot_pk

  - name: mart_crm_opportunity_7th_day_weekly_snapshot
    columns:
      - name: crm_opportunity_snapshot_id
        description: Unique identifier of a crm opportunity in the daily snapshot models
        data_tests:
          - not_null
          - unique
          - relationships:
              to: ref('fct_crm_opportunity_7th_day_weekly_snapshot')
              field: crm_opportunity_snapshot_id
  - name: mart_crm_opportunity_7th_day_weekly_snapshot_aggregate
    columns:
      - name: opportunity_weekly_snapshot_aggregate_pk
        data_tests:
          - not_null
          - unique
          - relationships:
              to: ref('fct_crm_opportunity_7th_day_weekly_snapshot_aggregate')
              field: opportunity_weekly_snapshot_aggregate_pk

