{{ config({
    "materialized": "view",
    })
}}

SELECT 
    google_analytics_4_events_source.*,
    CASE
        WHEN LOWER(medium) IS NULL AND LOWER(source) IS NULL AND page_referrer NOT LIKE '%gitlab.com%'
        THEN 'referral'
        WHEN LOWER(medium) IS NULL AND LOWER(source) IS NULL
        THEN 'direct'
        WHEN LOWER(medium) LIKE '%email%' 
            OR LOWER(source) LIKE '%email%'
        THEN 'email'
        WHEN LOWER(medium) LIKE '%cpm%' 
            OR LOWER(medium) LIKE '%display%'
            OR LOWER(medium) = 'banner'
            OR (LOWER(source) = 'bsa' AND LOWER(medium) = 'banner')
            OR (LOWER(source) = 'google' AND LOWER(medium) = 'cpc' AND LOWER(campaign) LIKE '%youtube%')
            OR (LOWER(source) = 'google' AND LOWER(medium) = 'cpc' AND LOWER(campaign) LIKE '%display%')
            OR (LOWER(source) = 'bidtellect' AND LOWER(medium) = 'cpc')
        THEN 'display'
        WHEN (LOWER(source) = 'capterra' AND LOWER(medium) = 'cpc')
            OR (LOWER(source) = 'getapp' AND LOWER(medium) = 'cpc')
            OR (LOWER(source) IS NOT NULL AND LOWER(medium) LIKE '%cpc%')
        THEN 'paid search'
        WHEN LOWER(medium) LIKE '%paidsocial%'
        THEN 'paid social'
        WHEN LOWER(medium) = 'organic'
            OR (LOWER(medium) = 'referral' AND LOWER(source) IN ('yandex', 'bing', 'yahoo', 'msn', 'sogou', 'baidu', 'lens.google.com', 'naver.com', 'so.com', 'news.google.com', 'search.google.com', 'poczta.onet.pl', 'websearch.rakuten.co.jp', 'duckduckgo.com'))
            OR LOWER(source) LIKE '%360.cn%'
            OR LOWER(source) LIKE '%alice%'
            OR LOWER(source) LIKE '%aol%'
            OR LOWER(source) LIKE '%ar.search.yahoo.com%'
            OR LOWER(source) LIKE '%ask%'
            OR LOWER(source) LIKE '%at.search.yahoo.com%'
            OR LOWER(source) LIKE '%au.search.yahoo.com%'
            OR LOWER(source) LIKE '%auone%'
            OR LOWER(source) LIKE '%avg%'
            OR LOWER(source) LIKE '%babylon%'
            OR LOWER(source) LIKE '%baidu%'
            OR LOWER(source) LIKE '%biglobe%'
            OR LOWER(source) LIKE '%biglobe.co.jp%'
            OR LOWER(source) LIKE '%biglobe.ne.jp%'
            OR LOWER(source) LIKE '%bing%'
            OR LOWER(source) LIKE '%br.search.yahoo.com%'
            OR LOWER(source) LIKE '%ca.search.yahoo.com%'
            OR LOWER(source) LIKE '%centrum.cz%'
            OR LOWER(source) LIKE '%ch.search.yahoo.com%'
            OR LOWER(source) LIKE '%cl.search.yahoo.com%'
            OR LOWER(source) LIKE '%cn.bing.com%'
            OR LOWER(source) LIKE '%cnn%'
            OR LOWER(source) LIKE '%co.search.yahoo.com%'
            OR LOWER(source) LIKE '%comcast%'
            OR LOWER(source) LIKE '%conduit%'
            OR LOWER(source) LIKE '%daum%'
            OR LOWER(source) LIKE '%daum.net%'
            OR LOWER(source) LIKE '%de.search.yahoo.com%'
            OR LOWER(source) LIKE '%dk.search.yahoo.com%'
            OR LOWER(source) LIKE '%dogpile%'
            OR LOWER(source) LIKE '%dogpile.com%'
            OR LOWER(source) LIKE '%duckduckgo%'
            OR LOWER(source) LIKE '%ecosia.org%'
            OR LOWER(source) LIKE '%email.seznam.cz%'
            OR LOWER(source) LIKE '%eniro%'
            OR LOWER(source) LIKE '%es.search.yahoo.com%'
            OR LOWER(source) LIKE '%espanol.search.yahoo.com%'
            OR LOWER(source) LIKE '%exalead.com%'
            OR LOWER(source) LIKE '%excite.com%'
            OR LOWER(source) LIKE '%fi.search.yahoo.com%'
            OR LOWER(source) LIKE '%firmy.cz%'
            OR LOWER(source) LIKE '%fr.search.yahoo.com%'
            OR LOWER(source) LIKE '%globo%'
            OR LOWER(source) LIKE '%go.mail.ru%'
            OR LOWER(source) LIKE '%google%'
            OR LOWER(source) LIKE '%google-play%'
            OR LOWER(source) LIKE '%hk.search.yahoo.com%'
            OR LOWER(source) LIKE '%id.search.yahoo.com%'
            OR LOWER(source) LIKE '%in.search.yahoo.com%'
            OR LOWER(source) LIKE '%incredimail%'
            OR LOWER(source) LIKE '%it.search.yahoo.com%'
            OR LOWER(source) LIKE '%kvasir%'
            OR LOWER(source) LIKE '%lens.google.com%'
            OR LOWER(source) LIKE '%lite.qwant.com%'
            OR LOWER(source) LIKE '%lycos%'
            OR LOWER(source) LIKE '%m.baidu.com%'
            OR LOWER(source) LIKE '%m.naver.com%'
            OR LOWER(source) LIKE '%m.search.naver.com%'
            OR LOWER(source) LIKE '%m.sogou.com%'
            OR LOWER(source) LIKE '%mail.rambler.ru%'
            OR LOWER(source) LIKE '%mail.yandex.ru%'
            OR LOWER(source) LIKE '%malaysia.search.yahoo.com%'
            OR LOWER(source) LIKE '%msn%'
            OR LOWER(source) LIKE '%msn.com%'
            OR LOWER(source) LIKE '%mx.search.yahoo.com%'
            OR LOWER(source) LIKE '%najdi%'
            OR LOWER(source) LIKE '%naver%'
            OR LOWER(source) LIKE '%naver.com%'
            OR LOWER(source) LIKE '%news.google.com%'
            OR LOWER(source) LIKE '%nl.search.yahoo.com%'
            OR LOWER(source) LIKE '%no.search.yahoo.com%'
            OR LOWER(source) LIKE '%ntp.msn.com%'
            OR LOWER(source) LIKE '%nz.search.yahoo.com%'
            OR LOWER(source) LIKE '%onet%'
            OR LOWER(source) LIKE '%onet.pl%'
            OR LOWER(source) LIKE '%pe.search.yahoo.com%'
            OR LOWER(source) LIKE '%ph.search.yahoo.com%'
            OR LOWER(source) LIKE '%pl.search.yahoo.com%'
            OR LOWER(source) LIKE '%play.google.com%'
            OR LOWER(source) LIKE '%qwant%'
            OR LOWER(source) LIKE '%qwant.com%'
            OR LOWER(source) LIKE '%rakuten%'
            OR LOWER(source) LIKE '%rakuten.co.jp%'
            OR LOWER(source) LIKE '%rambler%'
            OR LOWER(source) LIKE '%rambler.ru%'
            OR LOWER(source) LIKE '%se.search.yahoo.com%'
            OR LOWER(source) LIKE '%search-results%'
            OR LOWER(source) LIKE '%search.aol.co.uk%'
            OR LOWER(source) LIKE '%search.aol.com%'
            OR LOWER(source) LIKE '%search.google.com%'
            OR LOWER(source) LIKE '%search.smt.docomo.ne.jp%'
            OR LOWER(source) LIKE '%search.ukr.net%'
            OR LOWER(source) LIKE '%secureurl.ukr.net%'
            OR LOWER(source) LIKE '%seznam%'
            OR LOWER(source) LIKE '%seznam.cz%'
            OR LOWER(source) LIKE '%sg.search.yahoo.com%'
            OR LOWER(source) LIKE '%so.com%'
            OR LOWER(source) LIKE '%sogou%'
            OR LOWER(source) LIKE '%sogou.com%'
            OR LOWER(source) LIKE '%sp-web.search.auone.jp%'
            OR LOWER(source) LIKE '%startsiden%'
            OR LOWER(source) LIKE '%startsiden.no%'
            OR LOWER(source) LIKE '%suche.aol.de%'
            OR LOWER(source) LIKE '%terra%'
            OR LOWER(source) LIKE '%th.search.yahoo.com%'
            OR LOWER(source) LIKE '%tr.search.yahoo.com%'
            OR LOWER(source) LIKE '%tut.by%'
            OR LOWER(source) LIKE '%tw.search.yahoo.com%'
            OR LOWER(source) LIKE '%uk.search.yahoo.com%'
            OR LOWER(source) LIKE '%ukr%'
            OR LOWER(source) LIKE '%us.search.yahoo.com%'
            OR LOWER(source) LIKE '%virgilio%'
            OR LOWER(source) LIKE '%vn.search.yahoo.com%'
            OR LOWER(source) LIKE '%wap.sogou.com%'
            OR LOWER(source) LIKE '%webmaster.yandex.ru%'
            OR LOWER(source) LIKE '%websearch.rakuten.co.jp%'
            OR LOWER(source) LIKE '%yahoo%'
            OR LOWER(source) LIKE '%yahoo.co.jp%'
            OR LOWER(source) LIKE '%yahoo.com%'
            OR LOWER(source) LIKE '%yandex%'
            OR LOWER(source) LIKE '%yandex.by%'
            OR LOWER(source) LIKE '%yandex.com%'
            OR LOWER(source) LIKE '%yandex.com.tr%'
            OR LOWER(source) LIKE '%yandex.fr%'
            OR LOWER(source) LIKE '%yandex.kz%'
            OR LOWER(source) LIKE '%yandex.ru%'
            OR LOWER(source) LIKE '%yandex.ua%'
            OR LOWER(source) LIKE '%yandex.uz%'
            OR LOWER(source) LIKE '%zen.yandex.ru%'
        THEN 'organic search' 
        WHEN (LOWER(medium) = 'referral' AND LOWER(source) IN ('amazon', 'walmart', 'shopify', 'alibaba', 'stripe'))
            OR LOWER(source) LIKE '%aax-us-east.amazon-adsystem.com%'
            OR LOWER(source) LIKE '%aax.amazon-adsystem.com%'
            OR LOWER(source) LIKE '%alibaba%'
            OR LOWER(source) LIKE '%alibaba.com%'
            OR LOWER(source) LIKE '%amazon%'
            OR LOWER(source) LIKE '%amazon.co.uk%'
            OR LOWER(source) LIKE '%amazon.com%'
            OR LOWER(source) LIKE '%apps.shopify.com%'
            OR LOWER(source) LIKE '%checkout.shopify.com%'
            OR LOWER(source) LIKE '%checkout.stripe.com%'
            OR LOWER(source) LIKE '%cr.shopping.naver.com%'
            OR LOWER(source) LIKE '%cr2.shopping.naver.com%'
            OR LOWER(source) LIKE '%ebay%'
            OR LOWER(source) LIKE '%ebay.co.uk%'
            OR LOWER(source) LIKE '%ebay.com%'
            OR LOWER(source) LIKE '%ebay.com.au%'
            OR LOWER(source) LIKE '%ebay.de%'
            OR LOWER(source) LIKE '%etsy%'
            OR LOWER(source) LIKE '%etsy.com%'
            OR LOWER(source) LIKE '%Google Shopping%'
            OR LOWER(source) LIKE '%IGShopping%'
            OR LOWER(source) LIKE '%m.alibaba.com%'
            OR LOWER(source) LIKE '%m.shopping.naver.com%'
            OR LOWER(source) LIKE '%mercadolibre%'
            OR LOWER(source) LIKE '%mercadolibre.com%'
            OR LOWER(source) LIKE '%mercadolibre.com.ar%'
            OR LOWER(source) LIKE '%mercadolibre.com.mx%'
            OR LOWER(source) LIKE '%message.alibaba.com%'
            OR LOWER(source) LIKE '%msearch.shopping.naver.com%'
            OR LOWER(source) LIKE '%nl.shopping.net%'
            OR LOWER(source) LIKE '%no.shopping.net%'
            OR LOWER(source) LIKE '%offer.alibaba.com%'
            OR LOWER(source) LIKE '%one.walmart.com%'
            OR LOWER(source) LIKE '%order.shopping.yahoo.co.jp%'
            OR LOWER(source) LIKE '%partners.shopify.com%'
            OR LOWER(source) LIKE '%s3.amazonaws.com%'
            OR LOWER(source) LIKE '%se.shopping.net%'
            OR LOWER(source) LIKE '%shop.app%'
            OR LOWER(source) LIKE '%shopify%'
            OR LOWER(source) LIKE '%shopify.com%'
            OR LOWER(source) LIKE '%shopping.naver.com%'
            OR LOWER(source) LIKE '%shopping.yahoo.co.jp%'
            OR LOWER(source) LIKE '%shopping.yahoo.com%'
            OR LOWER(source) LIKE '%shopzilla%'
            OR LOWER(source) LIKE '%shopzilla.com%'
            OR LOWER(source) LIKE '%simplycodes.com%'
            OR LOWER(source) LIKE '%store.shopping.yahoo.co.jp%'
            OR LOWER(source) LIKE '%stripe%'
            OR LOWER(source) LIKE '%stripe.com%'
            OR LOWER(source) LIKE '%uk.shopping.net%'
            OR LOWER(source) LIKE '%walmart%'
            OR LOWER(source) LIKE '%walmart.com%'
        THEN 'organic shopping' 
        WHEN LOWER(medium) = 'social'
            OR (LOWER(medium) = 'referral' AND LOWER(source) IN ('reddit', 'linkedin', 'medium', 'ycombinator', 't.co', 'twitter', 'facebook', 'tencent', 'lnkd', 'sites.google.com', 'web.skype.com', 'instagram', 'stackoverflow', 'vk', 'zalo', 'groups.google.com', 'yammer', 'quora', 'meetup', 'messenger', 'blog.naver.com', 'netvibes', 'wordpress', 'glassdoor', 'dzone', 'slashdot', 'flipboard', 'blogspot', 'weibo', 'tripadvisor', 't.me', 'getpocket', 'whatsapp', 'hatena', 'livejournal'))
            OR LOWER(source) LIKE '%43things%'
            OR LOWER(source) LIKE '%43things.com%'
            OR LOWER(source) LIKE '%51.com%'
            OR LOWER(source) LIKE '%5ch.net%'
            OR LOWER(source) LIKE '%academia.edu%'
            OR LOWER(source) LIKE '%activerain%'
            OR LOWER(source) LIKE '%activerain.com%'
            OR LOWER(source) LIKE '%activeworlds%'
            OR LOWER(source) LIKE '%activeworlds.com%'
            OR LOWER(source) LIKE '%addthis%'
            OR LOWER(source) LIKE '%addthis.com%'
            OR LOWER(source) LIKE '%airg.ca%'
            OR LOWER(source) LIKE '%allnurses.com%'
            OR LOWER(source) LIKE '%allrecipes.com%'
            OR LOWER(source) LIKE '%alumniclass%'
            OR LOWER(source) LIKE '%alumniclass.com%'
            OR LOWER(source) LIKE '%ameba.jp%'
            OR LOWER(source) LIKE '%ameblo.jp%'
            OR LOWER(source) LIKE '%americantowns%'
            OR LOWER(source) LIKE '%americantowns.com%'
            OR LOWER(source) LIKE '%amp.reddit.com%'
            OR LOWER(source) LIKE '%ancestry.com%'
            OR LOWER(source) LIKE '%anobii%'
            OR LOWER(source) LIKE '%anobii.com%'
            OR LOWER(source) LIKE '%answerbag%'
            OR LOWER(source) LIKE '%answerbag.com%'
            OR LOWER(source) LIKE '%answers.yahoo.com%'
            OR LOWER(source) LIKE '%aolanswers%'
            OR LOWER(source) LIKE '%aolanswers.com%'
            OR LOWER(source) LIKE '%apps.facebook.com%'
            OR LOWER(source) LIKE '%ar.pinterest.com%'
            OR LOWER(source) LIKE '%artstation.com%'
            OR LOWER(source) LIKE '%askubuntu%'
            OR LOWER(source) LIKE '%askubuntu.com%'
            OR LOWER(source) LIKE '%asmallworld.com%'
            OR LOWER(source) LIKE '%athlinks%'
            OR LOWER(source) LIKE '%athlinks.com%'
            OR LOWER(source) LIKE '%away.vk.com%'
            OR LOWER(source) LIKE '%awe.sm%'
            OR LOWER(source) LIKE '%b.hatena.ne.jp%'
            OR LOWER(source) LIKE '%baby-gaga%'
            OR LOWER(source) LIKE '%baby-gaga.com%'
            OR LOWER(source) LIKE '%babyblog.ru%'
            OR LOWER(source) LIKE '%badoo%'
            OR LOWER(source) LIKE '%badoo.com%'
            OR LOWER(source) LIKE '%bebo%'
            OR LOWER(source) LIKE '%bebo.com%'
            OR LOWER(source) LIKE '%beforeitsnews%'
            OR LOWER(source) LIKE '%beforeitsnews.com%'
            OR LOWER(source) LIKE '%bharatstudent%'
            OR LOWER(source) LIKE '%bharatstudent.com%'
            OR LOWER(source) LIKE '%biip.no%'
            OR LOWER(source) LIKE '%biswap.org%'
            OR LOWER(source) LIKE '%bit.ly%'
            OR LOWER(source) LIKE '%blackcareernetwork.com%'
            OR LOWER(source) LIKE '%blackplanet%'
            OR LOWER(source) LIKE '%blackplanet.com%'
            OR LOWER(source) LIKE '%blip.fm%'
            OR LOWER(source) LIKE '%blog.com%'
            OR LOWER(source) LIKE '%blog.feedspot.com%'
            OR LOWER(source) LIKE '%blog.goo.ne.jp%'
            OR LOWER(source) LIKE '%blog.naver.com%'
            OR LOWER(source) LIKE '%blog.yahoo.co.jp%'
            OR LOWER(source) LIKE '%blogg.no%'
            OR LOWER(source) LIKE '%bloggang.com%'
            OR LOWER(source) LIKE '%blogger%'
            OR LOWER(source) LIKE '%blogger.com%'
            OR LOWER(source) LIKE '%blogher%'
            OR LOWER(source) LIKE '%blogher.com%'
            OR LOWER(source) LIKE '%bloglines%'
            OR LOWER(source) LIKE '%bloglines.com%'
            OR LOWER(source) LIKE '%blogs.com%'
            OR LOWER(source) LIKE '%blogsome%'
            OR LOWER(source) LIKE '%blogsome.com%'
            OR LOWER(source) LIKE '%blogspot%'
            OR LOWER(source) LIKE '%blogspot.com%'
            OR LOWER(source) LIKE '%blogster%'
            OR LOWER(source) LIKE '%blogster.com%'
            OR LOWER(source) LIKE '%blurtit%'
            OR LOWER(source) LIKE '%blurtit.com%'
            OR LOWER(source) LIKE '%bookmarks.yahoo.co.jp%'
            OR LOWER(source) LIKE '%bookmarks.yahoo.com%'
            OR LOWER(source) LIKE '%br.pinterest.com%'
            OR LOWER(source) LIKE '%brightkite%'
            OR LOWER(source) LIKE '%brightkite.com%'
            OR LOWER(source) LIKE '%brizzly%'
            OR LOWER(source) LIKE '%brizzly.com%'
            OR LOWER(source) LIKE '%business.facebook.com%'
            OR LOWER(source) LIKE '%buzzfeed%'
            OR LOWER(source) LIKE '%buzzfeed.com%'
            OR LOWER(source) LIKE '%buzznet%'
            OR LOWER(source) LIKE '%buzznet.com%'
            OR LOWER(source) LIKE '%cafe.naver.com%'
            OR LOWER(source) LIKE '%cafemom%'
            OR LOWER(source) LIKE '%cafemom.com%'
            OR LOWER(source) LIKE '%camospace%'
            OR LOWER(source) LIKE '%camospace.com%'
            OR LOWER(source) LIKE '%canalblog.com%'
            OR LOWER(source) LIKE '%care.com%'
            OR LOWER(source) LIKE '%care2%'
            OR LOWER(source) LIKE '%care2.com%'
            OR LOWER(source) LIKE '%caringbridge.org%'
            OR LOWER(source) LIKE '%catster%'
            OR LOWER(source) LIKE '%catster.com%'
            OR LOWER(source) LIKE '%cbnt.io%'
            OR LOWER(source) LIKE '%cellufun%'
            OR LOWER(source) LIKE '%cellufun.com%'
            OR LOWER(source) LIKE '%centerblog.net%'
            OR LOWER(source) LIKE '%chat.zalo.me%'
            OR LOWER(source) LIKE '%chegg.com%'
            OR LOWER(source) LIKE '%chicagonow%'
            OR LOWER(source) LIKE '%chicagonow.com%'
            OR LOWER(source) LIKE '%chiebukuro.yahoo.co.jp%'
            OR LOWER(source) LIKE '%classmates%'
            OR LOWER(source) LIKE '%classmates.com%'
            OR LOWER(source) LIKE '%classquest%'
            OR LOWER(source) LIKE '%classquest.com%'
            OR LOWER(source) LIKE '%co.pinterest.com%'
            OR LOWER(source) LIKE '%cocolog-nifty%'
            OR LOWER(source) LIKE '%cocolog-nifty.com%'
            OR LOWER(source) LIKE '%copainsdavant.linternaute.com%'
            OR LOWER(source) LIKE '%couchsurfing.org%'
            OR LOWER(source) LIKE '%cozycot%'
            OR LOWER(source) LIKE '%cozycot.com%'
            OR LOWER(source) LIKE '%cross.tv%'
            OR LOWER(source) LIKE '%crunchyroll%'
            OR LOWER(source) LIKE '%crunchyroll.com%'
            OR LOWER(source) LIKE '%cyworld%'
            OR LOWER(source) LIKE '%cyworld.com%'
            OR LOWER(source) LIKE '%cz.pinterest.com%'
            OR LOWER(source) LIKE '%d.hatena.ne.jp%'
            OR LOWER(source) LIKE '%dailystrength.org%'
            OR LOWER(source) LIKE '%deluxe.com%'
            OR LOWER(source) LIKE '%deviantart%'
            OR LOWER(source) LIKE '%deviantart.com%'
            OR LOWER(source) LIKE '%dianping%'
            OR LOWER(source) LIKE '%dianping.com%'
            OR LOWER(source) LIKE '%digg%'
            OR LOWER(source) LIKE '%digg.com%'
            OR LOWER(source) LIKE '%diigo%'
            OR LOWER(source) LIKE '%diigo.com%'
            OR LOWER(source) LIKE '%discover.hubpages.com%'
            OR LOWER(source) LIKE '%disqus%'
            OR LOWER(source) LIKE '%disqus.com%'
            OR LOWER(source) LIKE '%dogster%'
            OR LOWER(source) LIKE '%dogster.com%'
            OR LOWER(source) LIKE '%dol2day%'
            OR LOWER(source) LIKE '%dol2day.com%'
            OR LOWER(source) LIKE '%doostang%'
            OR LOWER(source) LIKE '%doostang.com%'
            OR LOWER(source) LIKE '%dopplr%'
            OR LOWER(source) LIKE '%dopplr.com%'
            OR LOWER(source) LIKE '%douban%'
            OR LOWER(source) LIKE '%douban.com%'
            OR LOWER(source) LIKE '%draft.blogger.com%'
            OR LOWER(source) LIKE '%draugiem.lv%'
            OR LOWER(source) LIKE '%drugs-forum%'
            OR LOWER(source) LIKE '%drugs-forum.com%'
            OR LOWER(source) LIKE '%dzone%'
            OR LOWER(source) LIKE '%dzone.com%'
            OR LOWER(source) LIKE '%edublogs.org%'
            OR LOWER(source) LIKE '%elftown%'
            OR LOWER(source) LIKE '%elftown.com%'
            OR LOWER(source) LIKE '%epicurious.com%'
            OR LOWER(source) LIKE '%everforo.com%'
            OR LOWER(source) LIKE '%exblog.jp%'
            OR LOWER(source) LIKE '%extole%'
            OR LOWER(source) LIKE '%extole.com%'
            OR LOWER(source) LIKE '%facebook%'
            OR LOWER(source) LIKE '%facebook.com%'
            OR LOWER(source) LIKE '%faceparty%'
            OR LOWER(source) LIKE '%faceparty.com%'
            OR LOWER(source) LIKE '%fandom.com%'
            OR LOWER(source) LIKE '%fanpop%'
            OR LOWER(source) LIKE '%fanpop.com%'
            OR LOWER(source) LIKE '%fark%'
            OR LOWER(source) LIKE '%fark.com%'
            OR LOWER(source) LIKE '%fb%'
            OR LOWER(source) LIKE '%fb.me%'
            OR LOWER(source) LIKE '%fc2%'
            OR LOWER(source) LIKE '%fc2.com%'
            OR LOWER(source) LIKE '%feedspot%'
            OR LOWER(source) LIKE '%feministing%'
            OR LOWER(source) LIKE '%feministing.com%'
            OR LOWER(source) LIKE '%filmaffinity%'
            OR LOWER(source) LIKE '%filmaffinity.com%'
            OR LOWER(source) LIKE '%flickr%'
            OR LOWER(source) LIKE '%flickr.com%'
            OR LOWER(source) LIKE '%flipboard%'
            OR LOWER(source) LIKE '%flipboard.com%'
            OR LOWER(source) LIKE '%folkdirect%'
            OR LOWER(source) LIKE '%folkdirect.com%'
            OR LOWER(source) LIKE '%foodservice%'
            OR LOWER(source) LIKE '%foodservice.com%'
            OR LOWER(source) LIKE '%forums.androidcentral.com%'
            OR LOWER(source) LIKE '%forums.crackberry.com%'
            OR LOWER(source) LIKE '%forums.imore.com%'
            OR LOWER(source) LIKE '%forums.nexopia.com%'
            OR LOWER(source) LIKE '%forums.webosnation.com%'
            OR LOWER(source) LIKE '%forums.wpcentral.com%'
            OR LOWER(source) LIKE '%fotki%'
            OR LOWER(source) LIKE '%fotki.com%'
            OR LOWER(source) LIKE '%fotolog%'
            OR LOWER(source) LIKE '%fotolog.com%'
            OR LOWER(source) LIKE '%foursquare%'
            OR LOWER(source) LIKE '%foursquare.com%'
            OR LOWER(source) LIKE '%free.facebook.com%'
            OR LOWER(source) LIKE '%friendfeed%'
            OR LOWER(source) LIKE '%friendfeed.com%'
            OR LOWER(source) LIKE '%fruehstueckstreff.org%'
            OR LOWER(source) LIKE '%fubar%'
            OR LOWER(source) LIKE '%fubar.com%'
            OR LOWER(source) LIKE '%gaiaonline%'
            OR LOWER(source) LIKE '%gaiaonline.com%'
            OR LOWER(source) LIKE '%gamerdna%'
            OR LOWER(source) LIKE '%gamerdna.com%'
            OR LOWER(source) LIKE '%gather.com%'
            OR LOWER(source) LIKE '%geni.com%'
            OR LOWER(source) LIKE '%getpocket.com%'
            OR LOWER(source) LIKE '%glassboard%'
            OR LOWER(source) LIKE '%glassboard.com%'
            OR LOWER(source) LIKE '%glassdoor%'
            OR LOWER(source) LIKE '%glassdoor.com%'
            OR LOWER(source) LIKE '%godtube%'
            OR LOWER(source) LIKE '%godtube.com%'
            OR LOWER(source) LIKE '%goldenline.pl%'
            OR LOWER(source) LIKE '%goldstar%'
            OR LOWER(source) LIKE '%goldstar.com%'
            OR LOWER(source) LIKE '%goo.gl%'
            OR LOWER(source) LIKE '%gooblog%'
            OR LOWER(source) LIKE '%goodreads%'
            OR LOWER(source) LIKE '%goodreads.com%'
            OR LOWER(source) LIKE '%google+%'
            OR LOWER(source) LIKE '%googlegroups.com%'
            OR LOWER(source) LIKE '%googleplus%'
            OR LOWER(source) LIKE '%govloop%'
            OR LOWER(source) LIKE '%govloop.com%'
            OR LOWER(source) LIKE '%gowalla%'
            OR LOWER(source) LIKE '%gowalla.com%'
            OR LOWER(source) LIKE '%gree.jp%'
            OR LOWER(source) LIKE '%groups.google.com%'
            OR LOWER(source) LIKE '%gulli.com%'
            OR LOWER(source) LIKE '%gutefrage.net%'
            OR LOWER(source) LIKE '%habbo%'
            OR LOWER(source) LIKE '%habbo.com%'
            OR LOWER(source) LIKE '%Hatena%'
            OR LOWER(source) LIKE '%hi5%'
            OR LOWER(source) LIKE '%hi5.com%'
            OR LOWER(source) LIKE '%hootsuite%'
            OR LOWER(source) LIKE '%hootsuite.com%'
            OR LOWER(source) LIKE '%houzz%'
            OR LOWER(source) LIKE '%houzz.com%'
            OR LOWER(source) LIKE '%hoverspot%'
            OR LOWER(source) LIKE '%hoverspot.com%'
            OR LOWER(source) LIKE '%hr.com%'
            OR LOWER(source) LIKE '%hu.pinterest.com%'
            OR LOWER(source) LIKE '%hubculture%'
            OR LOWER(source) LIKE '%hubculture.com%'
            OR LOWER(source) LIKE '%hubpages.com%'
            OR LOWER(source) LIKE '%hyves.net%'
            OR LOWER(source) LIKE '%hyves.nl%'
            OR LOWER(source) LIKE '%ibibo%'
            OR LOWER(source) LIKE '%ibibo.com%'
            OR LOWER(source) LIKE '%id.pinterest.com%'
            OR LOWER(source) LIKE '%identi.ca%'
            OR LOWER(source) LIKE '%ig%'
            OR LOWER(source) LIKE '%ImageShack%'
            OR LOWER(source) LIKE '%imageshack.com%'
            OR LOWER(source) LIKE '%imageshack.us%'
            OR LOWER(source) LIKE '%imvu%'
            OR LOWER(source) LIKE '%imvu.com%'
            OR LOWER(source) LIKE '%in.pinterest.com%'
            OR LOWER(source) LIKE '%insanejournal%'
            OR LOWER(source) LIKE '%insanejournal.com%'
            OR LOWER(source) LIKE '%instagram%'
            OR LOWER(source) LIKE '%instagram.com%'
            OR LOWER(source) LIKE '%instapaper%'
            OR LOWER(source) LIKE '%instapaper.com%'
            OR LOWER(source) LIKE '%internations.org%'
            OR LOWER(source) LIKE '%interpals.net%'
            OR LOWER(source) LIKE '%intherooms%'
            OR LOWER(source) LIKE '%intherooms.com%'
            OR LOWER(source) LIKE '%irc-galleria.net%'
            OR LOWER(source) LIKE '%is.gd%'
            OR LOWER(source) LIKE '%italki%'
            OR LOWER(source) LIKE '%italki.com%'
            OR LOWER(source) LIKE '%jammerdirect%'
            OR LOWER(source) LIKE '%jammerdirect.com%'
            OR LOWER(source) LIKE '%jappy.com%'
            OR LOWER(source) LIKE '%jappy.de%'
            OR LOWER(source) LIKE '%kaboodle.com%'
            OR LOWER(source) LIKE '%kakao%'
            OR LOWER(source) LIKE '%kakao.com%'
            OR LOWER(source) LIKE '%kakaocorp.com%'
            OR LOWER(source) LIKE '%kaneva%'
            OR LOWER(source) LIKE '%kaneva.com%'
            OR LOWER(source) LIKE '%kin.naver.com%'
            OR LOWER(source) LIKE '%l.facebook.com%'
            OR LOWER(source) LIKE '%l.instagram.com%'
            OR LOWER(source) LIKE '%l.messenger.com%'
            OR LOWER(source) LIKE '%last.fm%'
            OR LOWER(source) LIKE '%librarything%'
            OR LOWER(source) LIKE '%librarything.com%'
            OR LOWER(source) LIKE '%lifestream.aol.com%'
            OR LOWER(source) LIKE '%line%'
            OR LOWER(source) LIKE '%line.me%'
            OR LOWER(source) LIKE '%linkedin%'
            OR LOWER(source) LIKE '%linkedin.com%'
            OR LOWER(source) LIKE '%listal%'
            OR LOWER(source) LIKE '%listal.com%'
            OR LOWER(source) LIKE '%listography%'
            OR LOWER(source) LIKE '%listography.com%'
            OR LOWER(source) LIKE '%livedoor.com%'
            OR LOWER(source) LIKE '%livedoorblog%'
            OR LOWER(source) LIKE '%livejournal%'
            OR LOWER(source) LIKE '%livejournal.com%'
            OR LOWER(source) LIKE '%lm.facebook.com%'
            OR LOWER(source) LIKE '%lnkd.in%'
            OR LOWER(source) LIKE '%m.blog.naver.com%'
            OR LOWER(source) LIKE '%m.cafe.naver.com%'
            OR LOWER(source) LIKE '%m.facebook.com%'
            OR LOWER(source) LIKE '%m.kin.naver.com%'
            OR LOWER(source) LIKE '%m.vk.com%'
            OR LOWER(source) LIKE '%m.yelp.com%'
            OR LOWER(source) LIKE '%mbga.jp%'
            OR LOWER(source) LIKE '%medium.com%'
            OR LOWER(source) LIKE '%meetin.org%'
            OR LOWER(source) LIKE '%meetup%'
            OR LOWER(source) LIKE '%meetup.com%'
            OR LOWER(source) LIKE '%meinvz.net%'
            OR LOWER(source) LIKE '%meneame.net%'
            OR LOWER(source) LIKE '%menuism.com%'
            OR LOWER(source) LIKE '%messages.google.com%'
            OR LOWER(source) LIKE '%messages.yahoo.co.jp%'
            OR LOWER(source) LIKE '%messenger%'
            OR LOWER(source) LIKE '%messenger.com%'
            OR LOWER(source) LIKE '%mix.com%'
            OR LOWER(source) LIKE '%mixi.jp%'
            OR LOWER(source) LIKE '%mobile.facebook.com%'
            OR LOWER(source) LIKE '%mocospace%'
            OR LOWER(source) LIKE '%mocospace.com%'
            OR LOWER(source) LIKE '%mouthshut%'
            OR LOWER(source) LIKE '%mouthshut.com%'
            OR LOWER(source) LIKE '%movabletype%'
            OR LOWER(source) LIKE '%movabletype.com%'
            OR LOWER(source) LIKE '%mubi%'
            OR LOWER(source) LIKE '%mubi.com%'
            OR LOWER(source) LIKE '%my.opera.com%'
            OR LOWER(source) LIKE '%myanimelist.net%'
            OR LOWER(source) LIKE '%myheritage%'
            OR LOWER(source) LIKE '%myheritage.com%'
            OR LOWER(source) LIKE '%mylife%'
            OR LOWER(source) LIKE '%mylife.com%'
            OR LOWER(source) LIKE '%mymodernmet%'
            OR LOWER(source) LIKE '%mymodernmet.com%'
            OR LOWER(source) LIKE '%myspace%'
            OR LOWER(source) LIKE '%myspace.com%'
            OR LOWER(source) LIKE '%netvibes%'
            OR LOWER(source) LIKE '%netvibes.com%'
            OR LOWER(source) LIKE '%news.ycombinator.com%'
            OR LOWER(source) LIKE '%newsshowcase%'
            OR LOWER(source) LIKE '%nexopia%'
            OR LOWER(source) LIKE '%ngopost.org%'
            OR LOWER(source) LIKE '%niconico%'
            OR LOWER(source) LIKE '%nicovideo.jp%'
            OR LOWER(source) LIKE '%nightlifelink%'
            OR LOWER(source) LIKE '%nightlifelink.com%'
            OR LOWER(source) LIKE '%ning%'
            OR LOWER(source) LIKE '%ning.com%'
            OR LOWER(source) LIKE '%nl.pinterest.com%'
            OR LOWER(source) LIKE '%odnoklassniki.ru%'
            OR LOWER(source) LIKE '%odnoklassniki.ua%'
            OR LOWER(source) LIKE '%okwave.jp%'
            OR LOWER(source) LIKE '%old.reddit.com%'
            OR LOWER(source) LIKE '%oneworldgroup.org%'
            OR LOWER(source) LIKE '%onstartups%'
            OR LOWER(source) LIKE '%onstartups.com%'
            OR LOWER(source) LIKE '%opendiary%'
            OR LOWER(source) LIKE '%opendiary.com%'
            OR LOWER(source) LIKE '%oshiete.goo.ne.jp%'
            OR LOWER(source) LIKE '%out.reddit.com%'
            OR LOWER(source) LIKE '%over-blog.com%'
            OR LOWER(source) LIKE '%overblog.com%'
            OR LOWER(source) LIKE '%paper.li%'
            OR LOWER(source) LIKE '%partyflock.nl%'
            OR LOWER(source) LIKE '%photobucket%'
            OR LOWER(source) LIKE '%photobucket.com%'
            OR LOWER(source) LIKE '%pinboard%'
            OR LOWER(source) LIKE '%pinboard.in%'
            OR LOWER(source) LIKE '%pingsta%'
            OR LOWER(source) LIKE '%pingsta.com%'
            OR LOWER(source) LIKE '%pinterest%'
            OR LOWER(source) LIKE '%pinterest.at%'
            OR LOWER(source) LIKE '%pinterest.ca%'
            OR LOWER(source) LIKE '%pinterest.ch%'
            OR LOWER(source) LIKE '%pinterest.cl%'
            OR LOWER(source) LIKE '%pinterest.co.kr%'
            OR LOWER(source) LIKE '%pinterest.co.uk%'
            OR LOWER(source) LIKE '%pinterest.com%'
            OR LOWER(source) LIKE '%pinterest.com.au%'
            OR LOWER(source) LIKE '%pinterest.com.mx%'
            OR LOWER(source) LIKE '%pinterest.de%'
            OR LOWER(source) LIKE '%pinterest.es%'
            OR LOWER(source) LIKE '%pinterest.fr%'
            OR LOWER(source) LIKE '%pinterest.it%'
            OR LOWER(source) LIKE '%pinterest.jp%'
            OR LOWER(source) LIKE '%pinterest.nz%'
            OR LOWER(source) LIKE '%pinterest.ph%'
            OR LOWER(source) LIKE '%pinterest.pt%'
            OR LOWER(source) LIKE '%pinterest.ru%'
            OR LOWER(source) LIKE '%pinterest.se%'
            OR LOWER(source) LIKE '%pixiv.net%'
            OR LOWER(source) LIKE '%pl.pinterest.com%'
            OR LOWER(source) LIKE '%playahead.se%'
            OR LOWER(source) LIKE '%plurk%'
            OR LOWER(source) LIKE '%plurk.com%'
            OR LOWER(source) LIKE '%plus.google.com%'
            OR LOWER(source) LIKE '%plus.url.google.com%'
            OR LOWER(source) LIKE '%pocket.co%'
            OR LOWER(source) LIKE '%posterous%'
            OR LOWER(source) LIKE '%posterous.com%'
            OR LOWER(source) LIKE '%pro.homeadvisor.com%'
            OR LOWER(source) LIKE '%pulse.yahoo.com%'
            OR LOWER(source) LIKE '%qapacity%'
            OR LOWER(source) LIKE '%qapacity.com%'
            OR LOWER(source) LIKE '%quechup%'
            OR LOWER(source) LIKE '%quechup.com%'
            OR LOWER(source) LIKE '%quora%'
            OR LOWER(source) LIKE '%quora.com%'
            OR LOWER(source) LIKE '%qzone.qq.com%'
            OR LOWER(source) LIKE '%ravelry%'
            OR LOWER(source) LIKE '%ravelry.com%'
            OR LOWER(source) LIKE '%reddit%'
            OR LOWER(source) LIKE '%reddit.com%'
            OR LOWER(source) LIKE '%redux%'
            OR LOWER(source) LIKE '%redux.com%'
            OR LOWER(source) LIKE '%renren%'
            OR LOWER(source) LIKE '%renren.com%'
            OR LOWER(source) LIKE '%researchgate.net%'
            OR LOWER(source) LIKE '%reunion%'
            OR LOWER(source) LIKE '%reunion.com%'
            OR LOWER(source) LIKE '%reverbnation%'
            OR LOWER(source) LIKE '%reverbnation.com%'
            OR LOWER(source) LIKE '%rtl.de%'
            OR LOWER(source) LIKE '%ryze%'
            OR LOWER(source) LIKE '%ryze.com%'
            OR LOWER(source) LIKE '%salespider%'
            OR LOWER(source) LIKE '%salespider.com%'
            OR LOWER(source) LIKE '%scoop.it%'
            OR LOWER(source) LIKE '%screenrant%'
            OR LOWER(source) LIKE '%screenrant.com%'
            OR LOWER(source) LIKE '%scribd%'
            OR LOWER(source) LIKE '%scribd.com%'
            OR LOWER(source) LIKE '%scvngr%'
            OR LOWER(source) LIKE '%scvngr.com%'
            OR LOWER(source) LIKE '%secondlife%'
            OR LOWER(source) LIKE '%secondlife.com%'
            OR LOWER(source) LIKE '%serverfault%'
            OR LOWER(source) LIKE '%serverfault.com%'
            OR LOWER(source) LIKE '%shareit%'
            OR LOWER(source) LIKE '%sharethis%'
            OR LOWER(source) LIKE '%sharethis.com%'
            OR LOWER(source) LIKE '%shvoong.com%'
            OR LOWER(source) LIKE '%sites.google.com%'
            OR LOWER(source) LIKE '%skype%'
            OR LOWER(source) LIKE '%skyrock%'
            OR LOWER(source) LIKE '%skyrock.com%'
            OR LOWER(source) LIKE '%slashdot.org%'
            OR LOWER(source) LIKE '%slideshare.net%'
            OR LOWER(source) LIKE '%smartnews.com%'
            OR LOWER(source) LIKE '%snapchat%'
            OR LOWER(source) LIKE '%snapchat.com%'
            OR LOWER(source) LIKE '%social%'
            OR LOWER(source) LIKE '%sociallife.com.br%'
            OR LOWER(source) LIKE '%socialvibe%'
            OR LOWER(source) LIKE '%socialvibe.com%'
            OR LOWER(source) LIKE '%spaces.live.com%'
            OR LOWER(source) LIKE '%spoke%'
            OR LOWER(source) LIKE '%spoke.com%'
            OR LOWER(source) LIKE '%spruz%'
            OR LOWER(source) LIKE '%spruz.com%'
            OR LOWER(source) LIKE '%ssense.com%'
            OR LOWER(source) LIKE '%stackapps%'
            OR LOWER(source) LIKE '%stackapps.com%'
            OR LOWER(source) LIKE '%stackexchange%'
            OR LOWER(source) LIKE '%stackexchange.com%'
            OR LOWER(source) LIKE '%stackoverflow%'
            OR LOWER(source) LIKE '%stackoverflow.com%'
            OR LOWER(source) LIKE '%stardoll.com%'
            OR LOWER(source) LIKE '%stickam%'
            OR LOWER(source) LIKE '%stickam.com%'
            OR LOWER(source) LIKE '%studivz.net%'
            OR LOWER(source) LIKE '%suomi24.fi%'
            OR LOWER(source) LIKE '%superuser%'
            OR LOWER(source) LIKE '%superuser.com%'
            OR LOWER(source) LIKE '%sweeva%'
            OR LOWER(source) LIKE '%sweeva.com%'
            OR LOWER(source) LIKE '%t.co%'
            OR LOWER(source) LIKE '%t.me%'
            OR LOWER(source) LIKE '%tagged%'
            OR LOWER(source) LIKE '%tagged.com%'
            OR LOWER(source) LIKE '%taggedmail%'
            OR LOWER(source) LIKE '%taggedmail.com%'
            OR LOWER(source) LIKE '%talkbiznow%'
            OR LOWER(source) LIKE '%talkbiznow.com%'
            OR LOWER(source) LIKE '%taringa.net%'
            OR LOWER(source) LIKE '%techmeme%'
            OR LOWER(source) LIKE '%techmeme.com%'
            OR LOWER(source) LIKE '%tencent%'
            OR LOWER(source) LIKE '%tencent.com%'
            OR LOWER(source) LIKE '%tiktok%'
            OR LOWER(source) LIKE '%tiktok.com%'
            OR LOWER(source) LIKE '%tinyurl%'
            OR LOWER(source) LIKE '%tinyurl.com%'
            OR LOWER(source) LIKE '%toolbox%'
            OR LOWER(source) LIKE '%toolbox.com%'
            OR LOWER(source) LIKE '%touch.facebook.com%'
            OR LOWER(source) LIKE '%tr.pinterest.com%'
            OR LOWER(source) LIKE '%travellerspoint%'
            OR LOWER(source) LIKE '%travellerspoint.com%'
            OR LOWER(source) LIKE '%tripadvisor%'
            OR LOWER(source) LIKE '%tripadvisor.com%'
            OR LOWER(source) LIKE '%trombi%'
            OR LOWER(source) LIKE '%trombi.com%'
            OR LOWER(source) LIKE '%trustpilot%'
            OR LOWER(source) LIKE '%tudou%'
            OR LOWER(source) LIKE '%tudou.com%'
            OR LOWER(source) LIKE '%tuenti%'
            OR LOWER(source) LIKE '%tuenti.com%'
            OR LOWER(source) LIKE '%tumblr%'
            OR LOWER(source) LIKE '%tumblr.com%'
            OR LOWER(source) LIKE '%tweetdeck%'
            OR LOWER(source) LIKE '%tweetdeck.com%'
            OR LOWER(source) LIKE '%twitter%'
            OR LOWER(source) LIKE '%twitter.com%'
            OR LOWER(source) LIKE '%twoo.com%'
            OR LOWER(source) LIKE '%typepad%'
            OR LOWER(source) LIKE '%typepad.com%'
            OR LOWER(source) LIKE '%unblog.fr%'
            OR LOWER(source) LIKE '%urbanspoon.com%'
            OR LOWER(source) LIKE '%ushareit.com%'
            OR LOWER(source) LIKE '%ushi.cn%'
            OR LOWER(source) LIKE '%vampirefreaks%'
            OR LOWER(source) LIKE '%vampirefreaks.com%'
            OR LOWER(source) LIKE '%vampirerave%'
            OR LOWER(source) LIKE '%vampirerave.com%'
            OR LOWER(source) LIKE '%vg.no%'
            OR LOWER(source) LIKE '%video.ibm.com%'
            OR LOWER(source) LIKE '%vk.com%'
            OR LOWER(source) LIKE '%vkontakte.ru%'
            OR LOWER(source) LIKE '%wakoopa%'
            OR LOWER(source) LIKE '%wakoopa.com%'
            OR LOWER(source) LIKE '%wattpad%'
            OR LOWER(source) LIKE '%wattpad.com%'
            OR LOWER(source) LIKE '%web.facebook.com%'
            OR LOWER(source) LIKE '%web.skype.com%'
            OR LOWER(source) LIKE '%webshots%'
            OR LOWER(source) LIKE '%webshots.com%'
            OR LOWER(source) LIKE '%wechat%'
            OR LOWER(source) LIKE '%wechat.com%'
            OR LOWER(source) LIKE '%weebly%'
            OR LOWER(source) LIKE '%weebly.com%'
            OR LOWER(source) LIKE '%weibo%'
            OR LOWER(source) LIKE '%weibo.com%'
            OR LOWER(source) LIKE '%wer-weiss-was.de%'
            OR LOWER(source) LIKE '%weread%'
            OR LOWER(source) LIKE '%weread.com%'
            OR LOWER(source) LIKE '%whatsapp%'
            OR LOWER(source) LIKE '%whatsapp.com%'
            OR LOWER(source) LIKE '%wiki.answers.com%'
            OR LOWER(source) LIKE '%wikihow.com%'
            OR LOWER(source) LIKE '%wikitravel.org%'
            OR LOWER(source) LIKE '%woot.com%'
            OR LOWER(source) LIKE '%wordpress%'
            OR LOWER(source) LIKE '%wordpress.com%'
            OR LOWER(source) LIKE '%wordpress.org%'
            OR LOWER(source) LIKE '%xanga%'
            OR LOWER(source) LIKE '%xanga.com%'
            OR LOWER(source) LIKE '%xing%'
            OR LOWER(source) LIKE '%xing.com%'
            OR LOWER(source) LIKE '%yahoo-mbga.jp%'
            OR LOWER(source) LIKE '%yammer%'
            OR LOWER(source) LIKE '%yammer.com%'
            OR LOWER(source) LIKE '%yelp%'
            OR LOWER(source) LIKE '%yelp.co.uk%'
            OR LOWER(source) LIKE '%yelp.com%'
            OR LOWER(source) LIKE '%youroom.in%'
            OR LOWER(source) LIKE '%za.pinterest.com%'
            OR LOWER(source) LIKE '%zalo%'
            OR LOWER(source) LIKE '%zoo.gr%'
            OR LOWER(source) LIKE '%zooppa%'
            OR LOWER(source) LIKE '%zooppa.com%'
        THEN 'organic social' 
        WHEN (LOWER(source) LIKE '%youtube%' AND LOWER(medium) = 'referral')
            OR (LOWER(source) LIKE '%vimeo%' AND LOWER(medium) = 'referral')
            OR (LOWER(source) LIKE '%iqiyi%' AND LOWER(medium) = 'referral')
            OR (LOWER(source) LIKE '%youku%' AND LOWER(medium) = 'referral')
            OR LOWER(source) LIKE '%blog.twitch.tv%'
            OR LOWER(source) LIKE '%crackle%'
            OR LOWER(source) LIKE '%crackle.com%'
            OR LOWER(source) LIKE '%curiositystream%'
            OR LOWER(source) LIKE '%curiositystream.com%'
            OR LOWER(source) LIKE '%d.tube%'
            OR LOWER(source) LIKE '%dailymotion%'
            OR LOWER(source) LIKE '%dailymotion.com%'
            OR LOWER(source) LIKE '%dashboard.twitch.tv%'
            OR LOWER(source) LIKE '%disneyplus%'
            OR LOWER(source) LIKE '%disneyplus.com%'
            OR LOWER(source) LIKE '%fast.wistia.net%'
            OR LOWER(source) LIKE '%help.hulu.com%'
            OR LOWER(source) LIKE '%help.netflix.com%'
            OR LOWER(source) LIKE '%hulu%'
            OR LOWER(source) LIKE '%hulu.com%'
            OR LOWER(source) LIKE '%id.twitch.tv%'
            OR LOWER(source) LIKE '%iq.com%'
            OR LOWER(source) LIKE '%iqiyi%'
            OR LOWER(source) LIKE '%iqiyi.com%'
            OR LOWER(source) LIKE '%jobs.netflix.com%'
            OR LOWER(source) LIKE '%justin.tv%'
            OR LOWER(source) LIKE '%m.twitch.tv%'
            OR LOWER(source) LIKE '%m.youtube.com%'
            OR LOWER(source) LIKE '%music.youtube.com%'
            OR LOWER(source) LIKE '%netflix%'
            OR LOWER(source) LIKE '%netflix.com%'
            OR LOWER(source) LIKE '%player.twitch.tv%'
            OR LOWER(source) LIKE '%player.vimeo.com%'
            OR LOWER(source) LIKE '%ted%'
            OR LOWER(source) LIKE '%ted.com%'
            OR LOWER(source) LIKE '%twitch%'
            OR LOWER(source) LIKE '%twitch.tv%'
            OR LOWER(source) LIKE '%utreon%'
            OR LOWER(source) LIKE '%utreon.com%'
            OR LOWER(source) LIKE '%veoh%'
            OR LOWER(source) LIKE '%veoh.com%'
            OR LOWER(source) LIKE '%viadeo.journaldunet.com%'
            OR LOWER(source) LIKE '%vimeo%'
            OR LOWER(source) LIKE '%vimeo.com%'
            OR LOWER(source) LIKE '%wistia%'
            OR LOWER(source) LIKE '%wistia.com%'
            OR LOWER(source) LIKE '%youku%'
            OR LOWER(source) LIKE '%youku.com%'
            OR LOWER(source) LIKE '%youtube%'
            OR LOWER(source) LIKE '%youtube.com%'
        THEN 'organic video'
        WHEN source IS NOT NULL AND LOWER(medium) = 'referral'
        THEN 'referral'
        WHEN source IS NOT NULL
            OR LOWER(source) = 'other'
        THEN 'unassigned'
        ELSE 'Missing Channel Grouping'
    END AS channel
FROM {{ ref('google_analytics_4_events_source') }}